{% extends 'base.html' %}

{% block title %}College Dashboard{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>College Dashboard</h1>
        <p class="text-muted">Welcome, {{ user.profile.institution_name }}</p>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card stat-card-blue">
            <div class="stat-number">{{ total_students }}</div>
            <div class="stat-label">Total Students</div>
        </div>
        <div class="stat-card stat-card-green">
            <div class="stat-number">{{ total_certificates }}</div>
            <div class="stat-label">Certificates Issued</div>
        </div>
        <div class="stat-card stat-card-purple">
            <div class="stat-number">{{ blockchain_length }}</div>
            <div class="stat-label">Blockchain Blocks</div>
        </div>
        <div class="stat-card {% if chain_valid %}stat-card-green{% else %}stat-card-red{% endif %}">
            <div class="stat-number">{% if chain_valid %}Valid{% else %}Invalid{% endif %}</div>
            <div class="stat-label">Chain Status</div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="action-cards">
        <a href="{% url 'add_student' %}" class="action-card">
            <div class="action-icon">&#128100;</div>
            <h3>Add Student</h3>
            <p>Register a new student</p>
        </a>
        <a href="{% url 'upload_certificate' %}" class="action-card">
            <div class="action-icon">&#128196;</div>
            <h3>Upload Certificate</h3>
            <p>Issue a new certificate</p>
        </a>
        <a href="{% url 'blockchain_explorer' %}" class="action-card">
            <div class="action-icon">&#9939;</div>
            <h3>View Blockchain</h3>
            <p>Explore the chain</p>
        </a>
    </div>

    <!-- Recent Activity -->
    <div class="dashboard-grid">
        <div class="dashboard-section">
            <h2 class="section-title-sm">Recent Students</h2>
            {% if recent_students %}
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Student ID</th>
                            <th>Name</th>
                            <th>Department</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for student in recent_students %}
                        <tr>
                            <td><a href="{% url 'student_detail' student.id %}">{{ student.student_id }}</a></td>
                            <td>{{ student.name }}</td>
                            <td>{{ student.department|default:"-" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="empty-state">No students added yet. <a href="{% url 'add_student' %}">Add your first student</a>.</p>
            {% endif %}
        </div>

        <div class="dashboard-section">
            <h2 class="section-title-sm">Recent Certificates</h2>
            {% if recent_certificates %}
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Student</th>
                            <th>Block #</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for cert in recent_certificates %}
                        <tr>
                            <td><a href="{% url 'certificate_detail' cert.id %}">{{ cert.title }}</a></td>
                            <td>{{ cert.student.name }}</td>
                            <td><span class="badge badge-blockchain">#{{ cert.block_index }}</span></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="empty-state">No certificates uploaded yet. <a href="{% url 'upload_certificate' %}">Upload one now</a>.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
